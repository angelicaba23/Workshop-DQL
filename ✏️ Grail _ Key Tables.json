{"version":"7","defaultTimeframe":{"from":"now()-30m","to":"now()"},"defaultSegments":[],"sections":[{"id":"2c2a2267-a1ae-4967-8764-7dd52f3a8154","type":"markdown","markdown":"# Grail Key Tables\nEste Notebook proporciona casos de uso y documentación de las **4** principales  tablas de Grail.\n\n**Preguntas o feedback?**: [angelica.barranco@dynatrace.com](mailto:angelica.barranco@dynatrace.com?subject=Feedback%20on%20Grail)\n\nPara obtener más información sobre Grail, vaya aquí:\n* [(Doc) Grail](https://docs.dynatrace.com/docs/shortlink/grail)\n* [(Video) A Practical Guide to DQL](https://www.youtube.com/watch?v=ERU3onrM7Mw)\n* [(Video) Dynatrace Office Hours: Configuring Grail and managing data access](https://www.youtube.com/watch?v=Pwh0hmqqjIk)"},{"id":"976196de-6d10-4254-a9e2-1b6a8bb15b36","type":"markdown","markdown":"---"},{"id":"9f36baf1-93a2-4a4a-a803-8ec8254a510c","type":"markdown","markdown":"## Tengo que ser un experto en DQL para explorar la data de Grail❓ 👩🏻‍💻🧑🏽‍💻"},{"id":"2319df44-d73f-468f-91db-544f2ce5047f","type":"markdown","markdown":"![](https://media1.tenor.com/m/2fXbn6Xtt0UAAAAC/software-software-development.gif)"},{"id":"851180c6-0876-4c2f-a9c0-aee63ab0ce5c","type":"markdown","markdown":"## 1️⃣ Logs\nLos logs son registros que pueden provenir de diversas fuentes, incluidos Kubernetes, servicios en la nube, integraciones de API personalizadas o extensiones de Dynatrace.\n\n[APP - Logs](/ui/apps/dynatrace.logs)\n\n[Casos de uso](https://docs.dynatrace.com/docs/shortlink/logs-on-grail-examples)"},{"id":"9aaa24d3-f580-4104-9581-9350024918f3","type":"markdown","markdown":"> 💡Logs de `ERROR`"},{"id":"5b43c2c9-dbeb-482e-80fb-3c10981a169e","type":"dql","title":"Explore logs","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"logs","filter":" "}],"globalCommands":{"limit":20}},"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"previousQueryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"content = *ERROR*","datatype":"logs"}]},"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| limit 20"},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"5427aadb-c8d7-4dfa-b323-405543272336","type":"markdown","markdown":"🎯 Conteo de logs con contenido de `timeout` por pod."},{"id":"bceed90a-aac1-465f-8919-e82b6790ee9e","type":"dql","title":" Pods con logs de timeout","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"logs","summarize":{"fields":[],"aggregator":"count"},"filter":" "}]},"filterSegments":[],"drilldownPath":[],"previousQueryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"filter":"content = *timeout*","datatype":"logs"}]},"showInput":true,"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-2h","to":"now()"},"value":"fetch logs\n| summarize count = count()"},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":1,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":true},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"04d766d5-a0fa-4998-b811-586ac6f187bc","type":"markdown","markdown":"----"},{"id":"b6b21ef5-b375-4ad0-aad4-4a90ae2f75d4","type":"markdown","markdown":"# 2️⃣ Events \nLos eventos son cruciales para el monitoreo y la gestión de sistemas, ya que proporcionan información detallada sobre el comportamiento y el estado de los componentes monitoreados.\n\n[Casos de uso - Security data](https://docs.dynatrace.com/docs/shortlink/security-events-examples)"},{"id":"3f8ed30c-1860-4ad4-acc8-12c206abd65f","type":"markdown","markdown":">💡Tipos de eventos ingestados en las últimas 24h."},{"id":"d88426d9-bef5-4a50-bcef-b1b300a7345a","type":"dql","title":"Eventos por tipo","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"filter":"","datatype":"events"}]},"filterSegments":[],"drilldownPath":[],"previousQueryConfig":{"version":"11.4.0","subQueries":[{"id":"A","isEnabled":true,"sort":{"field":"count","direction":"desc"},"filter":"","datatype":"events","summarize":{"aggregator":"count","fields":["event.type"]}}]},"height":343,"showInput":true,"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-24h","to":"now()"},"value":"fetch events"},"visualizationSettings":{"chartSettings":{"truncationMode":"middle","categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxisLabel":"event.type","categoryAxis":["event.type"],"valueAxis":["count"],"valueAxisLabel":"count"}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"categoricalBarChart","result":{"code":200,"value":{"records":[{"event.type":"VULNERABILITY_STATE_REPORT_EVENT","count":"99150"},{"event.type":null,"count":"30920"},{"event.type":"RESOURCE_CONTENTION_EVENT","count":"22786"},{"event.type":"CUSTOM_INFO","count":"12908"},{"event.type":"COVERAGE_STATE_REPORT_EVENT","count":"12358"},{"event.type":"ERROR_EVENT","count":"3396"},{"event.type":"CUSTOM_ALERT","count":"3180"},{"event.type":"SERVICE_ERROR_RATE_INCREASED","count":"2458"},{"event.type":"SYNTHETIC_NODE_OUTAGE","count":"1432"},{"event.type":"SYNTHETIC_PRIVATE_LOCATION_OUTAGE","count":"1432"},{"event.type":"APPLICATION_ERROR_RATE_INCREASED","count":"389"},{"event.type":"OSI_HIGH_CPU","count":"264"},{"event.type":"VULNERABILITY_STATUS_CHANGE_EVENT","count":"208"},{"event.type":"SERVICE_SLOWDOWN","count":"194"},{"event.type":"CUSTOM_CONFIGURATION","count":"156"},{"event.type":"PROCESS_RESTART","count":"93"},{"event.type":"DETECTION_FINDING","count":"41"},{"event.type":"CUSTOM_DEPLOYMENT","count":"24"},{"event.type":"SERVICE_CLIENT_SLOWDOWN","count":"21"},{"event.type":"SERVICE_CLIENT_ERROR_RATE_INCREASED","count":"12"},{"event.type":"SERVICE_UNEXPECTED_HIGH_LOAD","count":"3"},{"event.type":"VULNERABILITY_ASSESSMENT_CHANGE_EVENT","count":"3"},{"event.type":"validation","count":"3"},{"event.type":"change","count":"2"},{"event.type":"test","count":"2"},{"event.type":"SERVICE_UNEXPECTED_LOW_LOAD","count":"1"},{"event.type":"build","count":"1"},{"event.type":"compile","count":"1"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| summarize by:{event.type}, count = count()\n| sort count desc","timezone":"America/Bogota","query":"fetch events\n| summarize count = count(), by: { event.type }\n| sort count desc","scannedRecords":200796,"dqlVersion":"V1_0","scannedBytes":677978482,"scannedDataPoints":0,"analysisTimeframe":{"start":"2024-10-28T15:43:01.458Z","end":"2024-10-29T15:43:01.458Z"},"locale":"en-US","executionTimeMilliseconds":180,"notifications":[],"queryId":"8e26f37d-8b46-4985-ba7d-48e0c959352a","sampled":false}},"types":[{"mappings":{"event.type":{"type":"string"},"count":{"type":"long"}},"indexRange":[0,27]}]},"notifications":[],"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"dateTime":"2024-10-29T15:43:01.883Z","input":{"timeframe":{"from":"now()-24h","to":"now()"},"value":"fetch events\n| summarize count = count(), by: { event.type }\n| sort count desc"}},"state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"ff148d9c-42f9-42ab-9d1e-307671f54cd6","type":"markdown","markdown":"🎯 Listado de procesos reiniciados durante y fuera de ventana de mantenimiento en las últimas 24h\n\n*Hints:*\n* Filtrar por `event.type = PROCESS_RESTART`\n* Contar por `dt.entity.process_group_instance.name` y `maintenance.is_under_maintenance`"},{"id":"0267ec81-6460-49df-8f9d-7c7d4dbdf8b8","type":"dql","title":"Lista de procesos reiniciados","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"filter":"","datatype":"events"}]},"filterSegments":[],"drilldownPath":[],"previousQueryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"filter":"","datatype":"events"}]},"showInput":true,"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-24h","to":"now()"},"value":"fetch events"},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"cb2c3078-2a68-4bf8-850f-751c9bda84a0","type":"markdown","markdown":"# 3️⃣ Bizevents\nUn evento es una acción que tiene lugar dentro de un sistema o servicio, como cuando un *cliente completa una transferencia* o cuando *un usuario selecciona un botón de suscripción*. El sistema produce una señal cuando ocurre un evento. Un evento se convierte en un **Business Event** cuando genera datos de nivel empresarial. \n\n[Casos de uso](https://docs.dynatrace.com/docs/platform-modules/business-analytics/ba-analysis)"},{"id":"7920bf71-9793-48cc-8631-2dacc69e2305","type":"markdown","markdown":"> 💡Conteo de business event ingestados en las últimas 2h."},{"id":"80b9a418-1ef8-44c0-a0da-2b3d74dc0953","type":"dql","title":"Explore Business Events","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"bizevents","filter":""}],"globalCommands":{"limit":20}},"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"previousQueryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"bizevents"}],"globalCommands":{"limit":20}},"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch bizevents\n| limit 20"},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"db1da63e-b197-4fb2-8d3f-e04fa0913fa3","type":"markdown","markdown":"🎯 Top 15 business event ingestados con el OneAgent en las últimas 24h.\n\nHints:\n\n* Filtrar por `dt.openpipeline.source = oneagent`\n* Contar por `event.type`\n* Limit `15`"},{"id":"158e3e07-8152-4932-8e65-f16a33f32e82","type":"dql","title":"Explore Business Events","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"bizevents","filter":""}],"globalCommands":{"limit":20}},"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"previousQueryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"bizevents"}],"globalCommands":{"limit":20}},"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch bizevents\n| limit 20"},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"state":"idle","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"51c8f96d-f14d-4a9c-9b68-3192370a22c6","type":"markdown","markdown":"# 4️⃣ Spans\nUn span es un registro de una interacción entre una solicitud y un servicio, desencadenada por la actividad de una solicitud que se mueve a través de múltiples servicios. Un span es una operación única dentro de una trace. Un span contiene metadatos y el contexto que se trasladará a lo largo de la traza.\n\n[APP - Distributed Tracing](/ui/apps/dynatrace.distributedtracing/explorer)"},{"id":"1d65bc1b-0a7a-413f-b59b-8d5a712ad2b8","type":"markdown","markdown":"> 🎯[Top Endpoints con error](/ui/apps/dynatrace.distributedtracing/explorer#)"},{"id":"0980c33f-4e78-4d28-b123-292f0dc2fc8d","type":"dql","title":"Explore Traces","queryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"spans","filter":" "}],"globalCommands":{"limit":20}},"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"previousQueryConfig":{"version":"16.4.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"spans","summarize":{"fields":["endpoint.name"],"aggregator":"count"},"filter":"request.is_failed = true "}],"globalCommands":{"limit":20}},"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch spans\n| limit 20"},"visualizationSettings":{"chartSettings":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}}}},{"id":"40d27247-b087-4aaf-ba2e-492f9000dfa1","type":"markdown","markdown":"## *️⃣ Otras tablas\n[Casos de uso - Davis](https://docs.dynatrace.com/docs/shortlink/davis-dql-examples)\n\n[Casos de uso - Topologia](https://docs.dynatrace.com/docs/shortlink/grail-querying-monitored-entities)\n\n[Casos de uso - System event models](https://docs.dynatrace.com/docs/shortlink/semantic-dictionary-system-event-models)"},{"id":"45b7acfe-a9d1-49a9-8bc4-173cc0b2f2f6","type":"markdown","markdown":"---\n**Preguntas o feedback?**: [angelica.barranco@dynatrace.com](mailto:angelica.barranco@dynatrace.com?subject=Feedback%20on%20Grail)\n\nPara obtener más información sobre Grail, vaya aquí:\n* [(Doc) Grail](https://docs.dynatrace.com/docs/shortlink/grail)\n* [(Video) A Practical Guide to DQL](https://www.youtube.com/watch?v=ERU3onrM7Mw)\n* [(Video) Dynatrace Office Hours: Configuring Grail and managing data access](https://www.youtube.com/watch?v=Pwh0hmqqjIk)"}]}